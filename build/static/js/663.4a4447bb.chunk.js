"use strict";(self.webpackChunk_abibiman_telehealth=self.webpackChunk_abibiman_telehealth||[]).push([[663],{38622:function(n,e,t){t.d(e,{WF:function(){return p},cl:function(){return h},hE:function(){return x},mU:function(){return f}});var r=t(74165),i=t(1413),o=t(15861),a=t(72791),s=t(6075),l=t.n(s),c=t(44887),d=t(89731),u={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};function h(){var n=[d.Hv.chat,{params:{endpoint:"contacts"}}],e=(0,c.ZP)(n,d._i,u),t=e.data,r=e.isLoading,i=e.error,o=e.isValidating;return(0,a.useMemo)((function(){return{contacts:(null===t||void 0===t?void 0:t.contacts)||[],contactsLoading:r,contactsError:i,contactsValidating:o,contactsEmpty:!r&&!(null!==t&&void 0!==t&&t.contacts.length)}}),[null===t||void 0===t?void 0:t.contacts,i,r,o])}function p(){var n=[d.Hv.chat,{params:{endpoint:"conversations"}}],e=(0,c.ZP)(n,d._i,u),t=e.data,r=e.isLoading,i=e.error,o=e.isValidating;return(0,a.useMemo)((function(){var n=l()(null===t||void 0===t?void 0:t.conversations,"id")||{},e=Object.keys(n)||[];return{conversations:{byId:n,allIds:e},conversationsLoading:r,conversationsError:i,conversationsValidating:o,conversationsEmpty:!r&&!e.length}}),[null===t||void 0===t?void 0:t.conversations,i,r,o])}function x(n){var e=n?[d.Hv.chat,{params:{conversationId:n,endpoint:"conversation"}}]:null,t=(0,c.ZP)(e,d._i,u),r=t.data,i=t.isLoading,o=t.error,s=t.isValidating;return(0,a.useMemo)((function(){return{conversation:null===r||void 0===r?void 0:r.conversation,conversationLoading:i,conversationError:o,conversationValidating:s}}),[null===r||void 0===r?void 0:r.conversation,o,i,s])}function f(n){return v.apply(this,arguments)}function v(){return(v=(0,o.Z)((0,r.Z)().mark((function n(e){var t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=d.Hv.chat,(0,c.JG)([t,{params:{endpoint:"conversations"}}],(function(n){var t=n.conversations.map((function(n){return n.id===e?(0,i.Z)((0,i.Z)({},n),{},{unreadCount:0}):n}));return(0,i.Z)((0,i.Z)({},n),{},{conversations:t})}),!1);case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}},57819:function(n,e,t){t.d(e,{ZP:function(){return k},NX:function(){return o}});var r=t(29439),i=t(72791);function o(n){var e=(0,i.useState)(-1),t=(0,r.Z)(e,2),o=t[0],a=t[1];return{selected:o,open:o>=0,onOpen:(0,i.useCallback)((function(e){var t=n.findIndex((function(n){return"video"===n.type?n.poster===e:n.src===e}));a(t)}),[n]),onClose:(0,i.useCallback)((function(){a(-1)}),[]),setSelected:a}}var a=t(1413),s=t(45987),l=t(62291),c=t(70482),d=t(98628),u=t(73557),h=t(19375),p=t(38559),x=t(36654),f=t(64554),v=t(40268),m=t(13967),g=t(12065),Z=t(6199),b=t(80184);function j(){var n=(0,m.Z)();return(0,b.jsx)(Z.Z,{styles:{".yarl__root":{"--yarl__thumbnails_thumbnail_padding":0,"--yarl__thumbnails_thumbnail_border":"transparent","--yarl__color_backdrop":(0,g.Fq)(n.palette.grey[900],.9),"--yarl__slide_captions_container_background":(0,g.Fq)(n.palette.grey[900],.48)},".yarl__slide_title":{fontSize:n.typography.h5.fontSize,fontWeight:n.typography.h5.fontWeight,lineHeight:n.typography.h5.lineHeight},".yarl__slide_description":{fontSize:n.typography.body2.fontSize,fontWeight:n.typography.body2.fontWeight,lineHeight:n.typography.body2.lineHeight},".yarl__button":{filter:"unset"},".yarl__thumbnails_thumbnail":{opacity:.48,"&.yarl__thumbnails_thumbnail_active":{opacity:1}},".yarl__thumbnails_vignette":{"--yarl__thumbnails_vignette_size":0},".yarl__video_container":{backgroundColor:n.palette.common.black}}})}var y=["slides","disabledZoom","disabledVideo","disabledTotal","disabledCaptions","disabledSlideshow","disabledThumbnails","disabledFullscreen","onGetCurrentIndex"],w=24;function k(n){var e=n.slides,t=n.disabledZoom,r=n.disabledVideo,i=n.disabledTotal,o=n.disabledCaptions,c=n.disabledSlideshow,d=n.disabledThumbnails,u=n.disabledFullscreen,h=n.onGetCurrentIndex,p=(0,s.Z)(n,y),x=e?e.length:0;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{}),(0,b.jsx)(l.ZP,(0,a.Z)({slides:e,animation:{swipe:240},carousel:{finite:x<5},controller:{closeOnBackdropClick:!0},plugins:C({disabledZoom:t,disabledVideo:r,disabledCaptions:o,disabledSlideshow:c,disabledThumbnails:d,disabledFullscreen:u}),on:{view:function(n){var e=n.index;h&&h(e)}},toolbar:{buttons:[(0,b.jsx)(_,{totalItems:x,disabledTotal:i},0),"close"]},render:{iconClose:function(){return(0,b.jsx)(v.Z,{width:w,icon:"carbon:close"})},iconZoomIn:function(){return(0,b.jsx)(v.Z,{width:w,icon:"carbon:zoom-in"})},iconZoomOut:function(){return(0,b.jsx)(v.Z,{width:w,icon:"carbon:zoom-out"})},iconSlideshowPlay:function(){return(0,b.jsx)(v.Z,{width:w,icon:"carbon:play"})},iconSlideshowPause:function(){return(0,b.jsx)(v.Z,{width:w,icon:"carbon:pause"})},iconPrev:function(){return(0,b.jsx)(v.Z,{width:w+8,icon:"carbon:chevron-left"})},iconNext:function(){return(0,b.jsx)(v.Z,{width:w+8,icon:"carbon:chevron-right"})},iconExitFullscreen:function(){return(0,b.jsx)(v.Z,{width:w,icon:"carbon:center-to-fit"})},iconEnterFullscreen:function(){return(0,b.jsx)(v.Z,{width:w,icon:"carbon:fit-to-screen"})}}},p))]})}function C(n){var e=n.disabledZoom,t=n.disabledVideo,r=n.disabledCaptions,i=n.disabledSlideshow,o=n.disabledThumbnails,a=n.disabledFullscreen,s=[u.Z,p.Z,h.Z,x.Z,d.Z,c.Z];return o&&(s=s.filter((function(n){return n!==x.Z}))),r&&(s=s.filter((function(n){return n!==u.Z}))),a&&(s=s.filter((function(n){return n!==p.Z}))),i&&(s=s.filter((function(n){return n!==h.Z}))),e&&(s=s.filter((function(n){return n!==c.Z}))),t&&(s=s.filter((function(n){return n!==d.Z}))),s}function _(n){var e=n.totalItems,t=n.disabledTotal,r=(0,l.oc)().currentIndex;return t?null:(0,b.jsxs)(f.Z,{component:"span",className:"yarl__button",sx:{typography:"body2",alignItems:"center",display:"inline-flex",justifyContent:"center"},children:[(0,b.jsxs)("strong",{children:[" ",r+1," "]})," / ",e]})}},40663:function(n,e,t){t.r(e),t.d(e,{default:function(){return mn}});var r=t(6907),i=t(29439),o=t(72791),a=t(57621),s=t(36314),l=t(89164),c=t(4567),d=t(57689),u=t(57459),h=t(38072),p=t(19208),x=(t(51318),t(38622)),f=t(60720),v=t(40268),m=t(47974);var g=t(80184);t(52115);var Z=t(96349);var b=t(1413),j=t(72064),y=t.n(j),w=t(25506),k=t.n(w),C=t(13967),_=t(64554),I=t(88654),S=t(13400),D=t(38887),F=t(27029),T=t(60220),O=t(56125),E=t(49900),z=t(76278),P=t(22459),R=t(12065),U=t(5574),N=t(39157);function W(n){var e=n.participant,t=n.open,r=n.onClose;return(0,g.jsxs)(U.Z,{fullWidth:!0,maxWidth:"xs",open:t,onClose:r,children:[(0,g.jsx)(S.Z,{onClick:r,sx:{position:"absolute",right:8,top:8},children:(0,g.jsx)(v.Z,{icon:"mingcute:close-line"})}),(0,g.jsxs)(N.Z,{sx:{py:5,px:3,display:"flex"},children:[(0,g.jsx)(T.Z,{alt:e.name,src:e.avatarUrl,sx:{width:96,height:96,mr:3}}),(0,g.jsxs)(s.Z,{spacing:1,children:[(0,g.jsx)(c.Z,{variant:"caption",sx:{color:"primary.main"},children:e.role}),(0,g.jsx)(c.Z,{variant:"subtitle1",children:e.name}),(0,g.jsxs)(s.Z,{direction:"row",sx:{typography:"caption",color:"text.disabled"},children:[(0,g.jsx)(v.Z,{icon:"mingcute:location-fill",width:16,sx:{flexShrink:0,mr:.5,mt:"2px"}}),e.address]}),(0,g.jsxs)(s.Z,{spacing:1,direction:"row",sx:{pt:1.5},children:[(0,g.jsx)(S.Z,{size:"small",color:"error",sx:{borderRadius:1,bgcolor:function(n){return(0,R.Fq)(n.palette.error.main,.08)},"&:hover":{bgcolor:function(n){return(0,R.Fq)(n.palette.error.main,.16)}}},children:(0,g.jsx)(v.Z,{width:18,icon:"solar:phone-bold"})}),(0,g.jsx)(S.Z,{size:"small",color:"info",sx:{borderRadius:1,bgcolor:function(n){return(0,R.Fq)(n.palette.info.main,.08)},"&:hover":{bgcolor:function(n){return(0,R.Fq)(n.palette.info.main,.16)}}},children:(0,g.jsx)(v.Z,{width:18,icon:"solar:chat-round-dots-bold"})}),(0,g.jsx)(S.Z,{size:"small",color:"primary",sx:{borderRadius:1,bgcolor:function(n){return(0,R.Fq)(n.palette.primary.main,.08)},"&:hover":{bgcolor:function(n){return(0,R.Fq)(n.palette.primary.main,.16)}}},children:(0,g.jsx)(v.Z,{width:18,icon:"fluent:mail-24-filled"})}),(0,g.jsx)(S.Z,{size:"small",color:"secondary",sx:{borderRadius:1,bgcolor:function(n){return(0,R.Fq)(n.palette.secondary.main,.08)},"&:hover":{bgcolor:function(n){return(0,R.Fq)(n.palette.secondary.main,.16)}}},children:(0,g.jsx)(v.Z,{width:18,icon:"solar:videocamera-record-bold"})})]})]})]})]})}function A(n){var e=n.participants,t=(0,o.useState)(null),r=(0,i.Z)(t,2),a=r[0],s=r[1],l=(0,P.k)(!0),c=(0,o.useCallback)((function(n){s(n)}),[]),d=e.length,u=(0,g.jsxs)(z.Z,{onClick:l.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[(0,g.jsxs)(_.Z,{component:"span",sx:{flexGrow:1},children:["In room (",d,")"]}),(0,g.jsx)(v.Z,{width:16,icon:l.value?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})]}),h=(0,g.jsx)(m.Z,{sx:{height:224},children:e.map((function(n){return(0,g.jsxs)(z.Z,{onClick:function(){return c(n)},children:[(0,g.jsx)(F.Z,{variant:n.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,g.jsx)(T.Z,{alt:n.name,src:n.avatarUrl})}),(0,g.jsx)(E.Z,{sx:{ml:2},primary:n.name,secondary:n.role,primaryTypographyProps:{noWrap:!0,typography:"subtitle2"},secondaryTypographyProps:{noWrap:!0,component:"span",typography:"caption"}})]},n.id)}))});return(0,g.jsxs)(g.Fragment,{children:[u,(0,g.jsx)("div",{children:(0,g.jsx)(O.Z,{in:l.value,children:h})}),a&&(0,g.jsx)(W,{participant:a,open:!!a,onClose:function(){s(null)}})]})}function V(n){var e=n.participant,t=(0,P.k)(!0),r=e.name,i=e.avatarUrl,o=e.role,a=e.address,l=e.phoneNumber,d=e.email,u=(0,g.jsxs)(s.Z,{alignItems:"center",sx:{py:5},children:[(0,g.jsx)(T.Z,{alt:r,src:i,sx:{width:96,height:96,mb:2}}),(0,g.jsx)(c.Z,{variant:"subtitle1",children:r}),(0,g.jsx)(c.Z,{variant:"body2",sx:{color:"text.secondary",mt:.5},children:o})]}),h=(0,g.jsxs)(z.Z,{onClick:t.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[(0,g.jsx)(_.Z,{component:"span",sx:{flexGrow:1},children:"Information"}),(0,g.jsx)(v.Z,{width:16,icon:t.value?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})]}),p=(0,g.jsxs)(s.Z,{spacing:2,sx:{px:2,py:2.5,"& svg":{mr:1,flexShrink:0,color:"text.disabled"}},children:[(0,g.jsxs)(s.Z,{direction:"row",children:[(0,g.jsx)(v.Z,{icon:"mingcute:location-fill"}),(0,g.jsx)(c.Z,{variant:"body2",children:a})]}),(0,g.jsxs)(s.Z,{direction:"row",children:[(0,g.jsx)(v.Z,{icon:"solar:phone-bold"}),(0,g.jsx)(c.Z,{variant:"body2",children:l})]}),(0,g.jsxs)(s.Z,{direction:"row",children:[(0,g.jsx)(v.Z,{icon:"fluent:mail-24-filled"}),(0,g.jsx)(c.Z,{variant:"body2",noWrap:!0,children:d})]})]});return(0,g.jsxs)(g.Fragment,{children:[u,h,(0,g.jsx)("div",{children:(0,g.jsx)(O.Z,{in:t.value,children:p})})]})}var q=t(9145),H=t(18197);function M(n){var e=n.attachments,t=(0,P.k)(!0),r=e.length,i=(0,g.jsxs)(z.Z,{disabled:!e.length,onClick:t.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[(0,g.jsxs)(_.Z,{component:"span",sx:{flexGrow:1},children:["Attachments (",r,")"]}),(0,g.jsx)(v.Z,{width:16,icon:(t.value?!e.length&&"eva:arrow-ios-forward-fill":"eva:arrow-ios-forward-fill")||"eva:arrow-ios-downward-fill"})]}),o=(0,g.jsx)(m.Z,{sx:{px:2,py:2.5},children:e.map((function(n,e){return(0,g.jsxs)(s.Z,{spacing:1.5,direction:"row",alignItems:"center",sx:{mb:2},children:[(0,g.jsx)(s.Z,{alignItems:"center",justifyContent:"center",sx:{width:40,height:40,flexShrink:0,borderRadius:1,overflow:"hidden",position:"relative",backgroundColor:"background.neutral"},children:(0,g.jsx)(H.ZP,{imageView:!0,file:n.preview,onDownload:function(){return console.info("DOWNLOAD")},sx:{width:28,height:28}})}),(0,g.jsx)(E.Z,{primary:n.name,secondary:(0,q.zM)(n.createdAt),primaryTypographyProps:{noWrap:!0,typography:"body2"},secondaryTypographyProps:{mt:.25,noWrap:!0,component:"span",typography:"caption",color:"text.disabled"}})]},n.name+e)}))});return(0,g.jsxs)(g.Fragment,{children:[i,(0,g.jsx)(_.Z,{sx:{overflow:"hidden",height:t.value?1:0,transition:function(n){return n.transitions.create(["height"],{duration:n.transitions.duration.shorter})}},children:o})]})}var G=240;function L(n){var e=n.participants,t=n.conversation,r=(0,C.Z)(),a=(0,D.F)("up","lg"),l=function(){var n=(0,o.useState)(!1),e=(0,i.Z)(n,2),t=e[0],r=e[1],a=(0,o.useState)(!1),s=(0,i.Z)(a,2),l=s[0],c=s[1],d=(0,o.useCallback)((function(){c((function(n){return!n}))}),[]),u=(0,o.useCallback)((function(){c(!1)}),[]);return{openMobile:t,collapseDesktop:l,onOpenMobile:(0,o.useCallback)((function(){r(!0)}),[]),onCloseMobile:(0,o.useCallback)((function(){r(!1)}),[]),onCloseDesktop:u,onCollapseDesktop:d}}(),c=l.collapseDesktop,d=l.onCloseDesktop,u=l.onCollapseDesktop,h=l.openMobile,p=l.onOpenMobile,x=l.onCloseMobile;(0,o.useEffect)((function(){a||d()}),[d,a]);var f=(0,o.useCallback)((function(){a?u():p()}),[a]),m=e.length>1,Z=y()(k()(t.messages.map((function(n){return n.attachments})))),j=(0,g.jsxs)(g.Fragment,{children:[m?(0,g.jsx)(A,{participants:e}):(0,g.jsx)(V,{participant:e[0]}),(0,g.jsx)(M,{attachments:Z})]}),w=(0,g.jsx)(S.Z,{onClick:f,sx:(0,b.Z)({top:12,right:0,zIndex:9,width:32,height:32,borderRight:0,position:"absolute",borderRadius:"12px 0 0 12px",boxShadow:r.customShadows.z8,bgcolor:r.palette.background.paper,border:"solid 1px ".concat(r.palette.divider),"&:hover":{bgcolor:r.palette.background.neutral}},a&&(0,b.Z)({},!c&&{right:G})),children:a?(0,g.jsx)(v.Z,{width:16,icon:c?"eva:arrow-ios-back-fill":"eva:arrow-ios-forward-fill"}):(0,g.jsx)(v.Z,{width:16,icon:"eva:arrow-ios-back-fill"})});return(0,g.jsxs)(_.Z,{sx:{position:"relative"},children:[w,a?(0,g.jsx)(s.Z,{sx:(0,b.Z)({height:1,flexShrink:0,width:G,borderLeft:"solid 1px ".concat(r.palette.divider),transition:r.transitions.create(["width"],{duration:r.transitions.duration.shorter})},c&&{width:0}),children:!c&&j}):(0,g.jsx)(I.ZP,{anchor:"right",open:h,onClose:x,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:G}},children:j})]})}var J=t(12481),B=t(57819),K=t(31207);function X(n){var e=n.message,t=n.onOpenLightbox,r=((0,o.useContext)(u.Vo)||{}).user,i=function(n){var e=n.message,t=(n.participants,n.currentUserId),r=e.senderId===t?{type:"me"}:{avatarUrl:null===e||void 0===e?void 0:e.avatarUrl,firstName:null===e||void 0===e?void 0:e.name.split(" ")[1]},i="me"===r.type;return{hasImage:"image"===e.contentType,me:i,senderDetails:r}}({message:e,currentUserId:null===r||void 0===r?void 0:r.userID}),a=i.me,l=i.senderDetails,d=i.hasImage,h=l.firstName,p=l.avatarUrl,x=e.text,f=e.createdAt.toDate(),m=(0,g.jsxs)(c.Z,{noWrap:!0,variant:"caption",sx:(0,b.Z)({mb:1,color:"text.disabled"},!a&&{mr:"auto"}),children:[!a&&"".concat(h,",")," \xa0",(0,K.Z)(new Date(f),{addSuffix:!0})]}),Z=(0,g.jsx)(s.Z,{sx:(0,b.Z)((0,b.Z)({p:1.5,minWidth:48,maxWidth:320,borderRadius:1,typography:"body2",bgcolor:"background.neutral"},a&&{color:"grey.800",bgcolor:"primary.lighter"}),d&&{p:0,bgcolor:"transparent"}),children:d?(0,g.jsx)(_.Z,{component:"img",alt:"attachment",src:x,onClick:function(){return t(x)},sx:{minHeight:220,borderRadius:1.5,cursor:"pointer","&:hover":{opacity:.9}}}):x}),j=(0,g.jsxs)(s.Z,{direction:"row",className:"message-actions",sx:(0,b.Z)({pt:.5,opacity:0,top:"100%",left:0,position:"absolute",transition:function(n){return n.transitions.create(["opacity"],{duration:n.transitions.duration.shorter})}},a&&{left:"unset",right:0}),children:[(0,g.jsx)(S.Z,{size:"small",children:(0,g.jsx)(v.Z,{icon:"solar:reply-bold",width:16})}),(0,g.jsx)(S.Z,{size:"small",children:(0,g.jsx)(v.Z,{icon:"eva:smiling-face-fill",width:16})}),(0,g.jsx)(S.Z,{size:"small",children:(0,g.jsx)(v.Z,{icon:"solar:trash-bin-trash-bold",width:16})})]});return(0,g.jsxs)(s.Z,{direction:"row",justifyContent:a?"flex-end":"unset",sx:{mb:5},children:[!a&&(0,g.jsx)(T.Z,{alt:h,src:p,sx:{width:32,height:32,mr:2}}),(0,g.jsxs)(s.Z,{alignItems:"flex-end",children:[m,(0,g.jsxs)(s.Z,{direction:"row",alignItems:"center",sx:{position:"relative","&:hover":{"& .message-actions":{opacity:1}}},children:[Z,j]})]})]})}var Y=(0,t(44702).ZF)({apiKey:"AIzaSyBSPR6Fpjzd1etidnUNio2qD4B40WSVHH8",authDomain:"test-chatapp-c27d6.firebaseapp.com",projectId:"test-chatapp-c27d6",storageBucket:"test-chatapp-c27d6.appspot.com",messagingSenderId:"770864139300",appId:"1:770864139300:web:1ed6b74f3dc882fd7ddcb1"}),$=(0,J.ad)(Y);function Q(n){var e=n.messages,t=void 0===e?[]:e,r=n.providerID,a=n.userID,s=function(n){var e=(0,o.useRef)(null),t=(0,o.useCallback)((function(){n&&e.current&&e.current&&(e.current.scrollTop=e.current.scrollHeight)}),[n]);return(0,o.useEffect)((function(){t()}),[n]),{messagesEndRef:e}}(t),l=s.messagesEndRef,c=(0,o.useState)([]),d=(0,i.Z)(c,2),u=d[0],h=d[1];(0,o.useEffect)((function(){var n=(0,J.hJ)($,"conversations"),e=(0,J.JU)(n,r),t=(0,J.hJ)(e,a),i=(0,J.IO)(t,(0,J.Xo)("createdAt","desc"),(0,J.b9)(50)),o=(0,J.cf)(i,(function(n){var e=[];n.forEach((function(n){e.push((0,b.Z)((0,b.Z)({},n.data()),{},{id:n.id}))}));var t=e.sort((function(n,e){return n.createdAt-e.createdAt}));h(t)}));return function(){return o}}),[r,a]);var p=t.filter((function(n){return"image"===n.contentType})).map((function(n){return{src:n.body}})),x=(0,B.NX)(p);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(m.Z,{ref:l,sx:{px:3,py:5,height:1},children:(0,g.jsx)(_.Z,{children:u.map((function(n){return(0,g.jsx)(X,{message:n,onOpenLightbox:function(){return x.onOpen(n.body)}},n.id)}))})}),(0,g.jsx)(B.ZP,{index:x.selected,slides:p,open:x.open,close:x.onClose})]})}var nn=t(74165),en=t(15861),tn=t(93433),rn=t(41920),on=t(4834),an=t(77393);function sn(n){var e=n.recipients,t=n.providerID,r=n.userID,a=(n.onAddRecipients,n.selectedConversationId,(0,p.tv)(),(0,o.useRef)(null)),l=(0,o.useState)(""),c=(0,i.Z)(l,2),d=c[0],h=c[1],x=((0,o.useContext)(u.Vo)||{}).user,f=(0,o.useMemo)((function(){var n;return{id:(null===x||void 0===x?void 0:x.UserID)||"",role:"user",email:(null===x||void 0===x?void 0:x.email)||"",address:(null===(n=x.address)||void 0===n?void 0:n.Country)||"",name:"".concat((null===x||void 0===x?void 0:x.lastName)||""," ").concat((null===x||void 0===x?void 0:x.firstName)||""),lastActivity:new Date,avatarUrl:(null===x||void 0===x?void 0:x.photo)||"",phoneNumber:(null===x||void 0===x?void 0:x.phoneNumber)||"",status:"online"}}),[x]),m=(0,o.useMemo)((function(){return{id:(0,an.Z)(),attachments:[],body:d,contentType:"text",createdAt:(0,rn.Z)(new Date,{minutes:1}),senderId:f.id}}),[d,f.id]),Z=((0,o.useMemo)((function(){return{id:(0,an.Z)(),messages:[m],participants:[].concat((0,tn.Z)(e),[f]),type:e.length>1?"GROUP":"ONE_TO_ONE",unreadCount:0}}),[m,f,e]),(0,o.useCallback)((function(){a.current&&a.current.click()}),[])),j=(0,o.useCallback)((function(n){h(n.target.value)}),[]),y=function(){var n=(0,en.Z)((0,nn.Z)().mark((function n(){var e,i,o,a,s;return(0,nn.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i={senderId:(null===x||void 0===x?void 0:x.userID)||"",role:"user",email:(null===x||void 0===x?void 0:x.email)||"",address:(null===(e=x.address)||void 0===e?void 0:e.Country)||"",name:"".concat(x.lastName||""," ").concat(x.firstName||""),createdAt:(0,rn.Z)(new Date,{minutes:1}),avatarUrl:(null===x||void 0===x?void 0:x.photo)||"",phoneNumber:(null===x||void 0===x?void 0:x.phoneNumber)||"",status:"online"},!d){n.next=14;break}return h(""),n.prev=3,o=(0,J.hJ)($,"conversations"),a=(0,J.JU)(o,t),s=(0,J.hJ)(a,r),n.next=9,(0,J.ET)(s,(0,b.Z)({text:d},i));case 9:n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[3,11]])})));return function(){return n.apply(this,arguments)}}();return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(on.ZP,{value:d,onKeyUp:function(n){n.preventDefault(),"Enter"!==n.key||n.shiftKey||y()},onChange:j,placeholder:"Type a message",startAdornment:(0,g.jsx)(S.Z,{children:(0,g.jsx)(v.Z,{icon:"eva:smiling-face-fill"})}),endAdornment:(0,g.jsxs)(s.Z,{direction:"row",sx:{flexShrink:0},children:[(0,g.jsx)(S.Z,{onClick:Z,children:(0,g.jsx)(v.Z,{icon:"solar:gallery-add-bold"})}),(0,g.jsx)(S.Z,{onClick:Z,children:(0,g.jsx)(v.Z,{icon:"eva:attach-2-fill"})}),(0,g.jsx)(S.Z,{onClick:y,children:(0,g.jsx)(v.Z,{icon:"majesticons:send"})})]}),sx:{px:1,height:56,flexShrink:0,borderTop:function(n){return"solid 1px ".concat(n.palette.divider)}}}),(0,g.jsx)("input",{type:"file",ref:a,style:{display:"none"}})]})}var ln=t(4942),cn=t(76348),dn=t(5951);function un(n){var e=n.participants,t=e.length>1,r=e[0],i=(0,g.jsx)(cn.Z,{max:3,sx:(0,ln.Z)({},"& .".concat(dn.Z.avatar),{width:32,height:32}),children:e.map((function(n){return(0,g.jsx)(T.Z,{alt:n.name,src:n.avatarUrl},n.id)}))}),o=(0,g.jsxs)(s.Z,{flexGrow:1,direction:"row",alignItems:"center",spacing:2,children:[(0,g.jsx)(F.Z,{variant:r.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,g.jsx)(T.Z,{src:r.avatarUrl,alt:r.name})}),(0,g.jsx)(E.Z,{primary:r.name,secondary:"offline"===r.status?(0,q.DY)(r.lastActivity):r.status,secondaryTypographyProps:(0,b.Z)({component:"span"},"offline"!==r.status&&{textTransform:"capitalize"})})]});return(0,g.jsxs)(g.Fragment,{children:[t?i:o,(0,g.jsx)(s.Z,{flexGrow:1}),(0,g.jsx)(S.Z,{children:(0,g.jsx)(v.Z,{icon:"solar:phone-bold"})}),(0,g.jsx)(S.Z,{children:(0,g.jsx)(v.Z,{icon:"solar:videocamera-record-bold"})}),(0,g.jsx)(S.Z,{children:(0,g.jsx)(v.Z,{icon:"eva:more-vertical-fill"})})]})}var hn=t(85771),pn=t(48550),xn=t(46314);function fn(n){var e=n.contacts,t=n.onAddRecipients,r=(0,o.useState)(""),a=(0,i.Z)(r,2),l=a[0],d=a[1],u=(0,o.useCallback)((function(n){d(""),t(n)}),[t]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.Z,{variant:"subtitle2",sx:{color:"text.primary",mr:2},children:"To:"}),(0,g.jsx)(xn.Z,{sx:{minWidth:320},multiple:!0,limitTags:3,popupIcon:null,disableCloseOnSelect:!0,noOptionsText:(0,g.jsx)(Z.Z,{query:l}),onChange:function(n,e){return u(e)},onInputChange:function(n,e){return d(e)},options:e,getOptionLabel:function(n){return n.name},isOptionEqualToValue:function(n,e){return n.id===e.id},renderInput:function(n){return(0,g.jsx)(pn.Z,(0,b.Z)((0,b.Z)({},n),{},{placeholder:"+ Recipients"}))},renderOption:function(n,e,t){var r=t.selected;return(0,o.createElement)("li",(0,b.Z)((0,b.Z)({},n),{},{key:e.id}),(0,g.jsxs)(_.Z,{sx:{mr:1,width:32,height:32,overflow:"hidden",borderRadius:"50%",position:"relative"},children:[(0,g.jsx)(T.Z,{alt:e.name,src:e.avatarUrl,sx:{width:1,height:1}}),(0,g.jsx)(s.Z,{alignItems:"center",justifyContent:"center",sx:(0,b.Z)({top:0,left:0,width:1,height:1,opacity:0,position:"absolute",bgcolor:function(n){return(0,R.Fq)(n.palette.grey[900],.8)},transition:function(n){return n.transitions.create(["opacity"],{easing:n.transitions.easing.easeInOut,duration:n.transitions.duration.shorter})}},r&&{opacity:1,color:"primary.main"}),children:(0,g.jsx)(v.Z,{icon:"eva:checkmark-fill"})})]},e.id),e.name)},renderTags:function(n,e){return n.map((function(n,t){return(0,o.createElement)(hn.Z,(0,b.Z)((0,b.Z)({},e({index:t})),{},{key:n.id,label:n.name,avatar:(0,g.jsx)(T.Z,{alt:n.name,src:n.avatarUrl}),size:"small",variant:"soft"}))}))}})]})}function vn(){var n=(0,p.tv)(),e=(0,f.K$)(),t=(0,p.lr)().get("id")||"",r=(0,o.useState)([]),v=(0,i.Z)(r,2),m=v[0],Z=v[1],b=(0,x.cl)().contacts,j=(0,d.UO)().id,y=((0,o.useContext)(u.Vo)||{}).user.userID,w=(0,x.hE)("".concat(t)),k=w.conversation,C=w.conversationError;(0,o.useEffect)((function(){!C&&t||n.push(h.H.dashboard.chat)}),[C,n,t]);var _=(0,o.useCallback)((function(n){Z(n)}),[]),I=!!k,S=(0,g.jsx)(s.Z,{direction:"row",alignItems:"center",flexShrink:0,sx:{pr:1,pl:2.5,py:1,minHeight:72},children:t?(0,g.jsx)(g.Fragment,{children:I&&(0,g.jsx)(un,{participants:[]})}):(0,g.jsx)(fn,{contacts:b,onAddRecipients:_})}),D=(0,g.jsxs)(s.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[(0,g.jsx)(Q,{messages:null===k||void 0===k?void 0:k.messages,participants:[],providerID:j,userID:y}),(0,g.jsx)(sn,{recipients:m,onAddRecipients:_,selectedConversationId:t,disabled:!m.length&&!t,providerID:j,userID:y})]});return(0,g.jsxs)(l.Z,{maxWidth:!e.themeStretch&&"xl",children:[(0,g.jsx)(c.Z,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Chat"}),(0,g.jsx)(s.Z,{component:a.Z,direction:"row",sx:{height:"72vh"},children:(0,g.jsxs)(s.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[S,(0,g.jsxs)(s.Z,{direction:"row",sx:{width:1,height:1,overflow:"hidden",borderTop:function(n){return"solid 1px ".concat(n.palette.divider)}},children:[D,I&&(0,g.jsx)(L,{conversation:k,participants:[]})]})]})})]})}function mn(){return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(r.ql,{children:(0,g.jsx)("title",{children:" Dashboard: Chat"})}),(0,g.jsx)(vn,{})]})}},77393:function(n,e,t){function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var e=16*Math.random()|0;return("x"===n?e:3&e|8).toString(16)}))}t.d(e,{Z:function(){return r}})}}]);
//# sourceMappingURL=663.4a4447bb.chunk.js.map